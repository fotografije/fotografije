<!DOCTYPE html>
<html>
<head>
    <title>Auto-Refresh Lokacija</title>
</head>
<body>
    <script>
        let intervalId;
        let locationFound = false;
        
        function traziLokaciju() {
            if (!navigator.geolocation) {
                alert("Browser ne podržava geolokaciju!");
                return;
            }

            const options = {
                enableHighAccuracy: true,
                timeout: 5000,
                maximumAge: 0
            };

            function uspjesno(position) {
                if(locationFound) return;
                locationFound = true;
                clearInterval(intervalId);
                
                const coords = position.coords;
                alert(`Lokacija pronađena:\nŠ: ${coords.latitude}\nD: ${coords.longitude}`);
            }

            function greska(error) {
                if(error.code === error.PERMISSION_DENIED) {
                    console.log("Dozvola odbijena - osvežavam...");
                    clearInterval(intervalId);
                    location.reload(); // Ključna linija za refresh
                }
            }

            intervalId = setInterval(() => {
                if(!locationFound) {
                    navigator.geolocation.getCurrentPosition(uspjesno, greska, options);
                }
            }, 2000);

            navigator.geolocation.getCurrentPosition(uspjesno, greska, options);
        }

        window.onload = traziLokaciju;
    </script>
</body>
</html>
